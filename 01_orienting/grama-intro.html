
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. A Grammar of Model Analysis: Grama &#8212; All Models Are Uncertain</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. A Brief Introduction to Data Tools" href="data-tools.html" />
    <link rel="prev" title="3. The Modeling Process" href="modeling-process.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">All Models Are Uncertain</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../preface.html">
                    Preface
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Orienting
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="orienting.html">
   1. Orienting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="curiosity-skepticism.html">
   2. Curiosity and Skepticism: A Healthy Mindset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="modeling-process.html">
   3. The Modeling Process
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. A Grammar of Model Analysis: Grama
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-tools.html">
   5. A Brief Introduction to Data Tools
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Developing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../02_developing/uncertainty.html">
   6. Conceptual Tools for Handling Uncertainty
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_developing/distributions.html">
   7. Distributions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/marginals.html">
     7.1. Single Uncertainties: Marginal Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/dependency.html">
     7.2. Multiple uncertainties: Modeling dependency
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/sampling.html">
     7.3. Dealing with Limited Data: Sampling Uncertainty
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_developing/functions.html">
   8. Functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/vectorized.html">
     8.1. Vectorizing Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/modeling-functions.html">
     8.2. Modeling Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/practical-fitting.html">
     8.3. Practical Fitting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/doe-surrogates.html">
     8.4. Sampling and Surrogates
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_developing/models.html">
   9. Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/dimension-reduction.html">
     9.1. Dimension Reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/dimensional-analysis.html">
     9.2. Dimensional Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/propagation-concepts.html">
     9.3. Uncertainty Propagation: Concepts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/propagation-algorithms.html">
     9.4. Uncertainty Propagation: Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_developing/ema.html">
     9.5. Exploratory Model Analysis (EMA)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Answering
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03_answering/answering.html">
   10. Answering
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_answering/decision-making.html">
     10.1. Making Decisions Under Uncertainty: Nuclear Waste Storage Safety
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_answering/model-assumptions.html">
     10.2. Assessing Model Assumptions: Disease Transmission and Social Connectivity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_answering/design-codes.html">
     10.3. Designing Procedures: Uncertainty-Informed Design Codes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_answering/interpretable-structure.html">
     10.4. Interpreting Model Structure: Solar Receiver
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04_appendices/cases.html">
   11. Datasets and Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_appendices/alloys.html">
     11.1. Datasets: Alloys
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_appendices/turbulence.html">
     11.2. Datasets: Turbulence Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_appendices/boats.html">
     11.3. Models: Boat hulls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_appendices/rlc-circuits.html">
     11.4. Models: RLC Circuits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_appendices/projectile-motion.html">
     11.5. Models: Projectile Motion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_appendices/piston.html">
     11.6. Models: Piston cycle time
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_appendices/solar-receiver.html">
     11.7. Models: Solar Receiver
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_appendices/limit-state-models.html">
     11.8. Models: Limit State Analysis and Structural Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_appendices/disease-models.html">
     11.9. Models: Agent-based Disease Transmission Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_appendices/eda.html">
   12. Fundamentals of Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_appendices/doe-gp.html">
   13. Sampling Plans for Gaussian Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_appendices/pr-modeling.html">
   14. Concepts in Random Variable Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_appendices/nls.html">
   15. Nonlinear Least Squares
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04_appendices/reproduce.html">
   16. Reproducibility Details
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/01_orienting/grama-intro.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/01_orienting/grama-intro.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quick-start-with-py-grama">
   4.1. Quick Start with
   <code class="docutils literal notranslate">
    <span class="pre">
     py-grama
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install">
     4.1.1. Install
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#install-anaconda-python">
       4.1.1.1. Install Anaconda Python.
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-the-python-package-manager-to-install-py-grama">
       4.1.1.2. Use the Python package manager to install
       <code class="docutils literal notranslate">
        <span class="pre">
         py-grama
        </span>
       </code>
       .
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#test-your-install">
       4.1.1.3. Test your install.
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jupyter-notebooks">
     4.1.2. Jupyter Notebooks
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#boilerplate-code">
     4.1.3. Boilerplate code
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-demo-model">
     4.1.4. A demo model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#overriding-the-defaults">
     4.1.5. Overriding the defaults
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-help">
     4.1.6. Getting help
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grama-concepts">
   4.2. Grama Concepts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objects-data-and-models">
     4.2.1. Objects: Data and models
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-df">
       4.2.1.1. Data (
       <code class="docutils literal notranslate">
        <span class="pre">
         df
        </span>
       </code>
       ).
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verbs-four-fundamental-verbs">
     4.2.2. Verbs: Four fundamental verbs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functional-programming">
     4.2.3. Functional programming
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-on-py-grama">
     4.2.4. More on
     <code class="docutils literal notranslate">
      <span class="pre">
       py-grama
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-brief-case-study-assessing-structural-safety">
   4.3. A Brief Case Study: Assessing Structural Safety
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-the-model">
     4.3.1. Building the model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyzing-the-model">
     4.3.2. Analyzing the model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-general-process">
   4.4. A general process
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>A Grammar of Model Analysis: Grama</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quick-start-with-py-grama">
   4.1. Quick Start with
   <code class="docutils literal notranslate">
    <span class="pre">
     py-grama
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#install">
     4.1.1. Install
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#install-anaconda-python">
       4.1.1.1. Install Anaconda Python.
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-the-python-package-manager-to-install-py-grama">
       4.1.1.2. Use the Python package manager to install
       <code class="docutils literal notranslate">
        <span class="pre">
         py-grama
        </span>
       </code>
       .
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#test-your-install">
       4.1.1.3. Test your install.
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jupyter-notebooks">
     4.1.2. Jupyter Notebooks
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#boilerplate-code">
     4.1.3. Boilerplate code
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-demo-model">
     4.1.4. A demo model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#overriding-the-defaults">
     4.1.5. Overriding the defaults
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#getting-help">
     4.1.6. Getting help
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grama-concepts">
   4.2. Grama Concepts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objects-data-and-models">
     4.2.1. Objects: Data and models
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-df">
       4.2.1.1. Data (
       <code class="docutils literal notranslate">
        <span class="pre">
         df
        </span>
       </code>
       ).
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verbs-four-fundamental-verbs">
     4.2.2. Verbs: Four fundamental verbs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functional-programming">
     4.2.3. Functional programming
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-on-py-grama">
     4.2.4. More on
     <code class="docutils literal notranslate">
      <span class="pre">
       py-grama
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-brief-case-study-assessing-structural-safety">
   4.3. A Brief Case Study: Assessing Structural Safety
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-the-model">
     4.3.1. Building the model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyzing-the-model">
     4.3.2. Analyzing the model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-general-process">
   4.4. A general process
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="a-grammar-of-model-analysis-grama">
<span id="grama-intro"></span><h1><span class="section-number">4. </span>A Grammar of Model Analysis: Grama<a class="headerlink" href="#a-grammar-of-model-analysis-grama" title="Permalink to this headline">#</a></h1>
<p id="index-0">This chapter is about a <strong>grammar of model analysis</strong>. Just like English grammar provides us with rules about the language, a grammar of model analysis gives rules about how objects fit together; specifically, <em>models</em>, <em>data</em>, and the <em>verbs</em> that relate them. This ruleset is designed to facilitate model analysis under uncertainty.</p>
<p>These rules are implemented in the Python package <code class="docutils literal notranslate"><span class="pre">py-grama</span></code>. Using the <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> package, you will be able to reproduce all of the case studies in this text. This means you can immediately take the code in this book and start applying it to your own studies! The <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> package is free and open source software, hosted on GitHub at this URL: <a class="reference external" href="https://github.com/zdelrosario/py_grama">https://github.com/zdelrosario/py_grama</a>.</p>
<p><strong>Learning Objectives</strong> In this chapter, you will learn:</p>
<ul class="simple">
<li><p>how to install the <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> Python package,</p></li>
<li><p>key concepts used in <code class="docutils literal notranslate"><span class="pre">py-grama</span></code>, and</p></li>
<li><p>the basics of using <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> to do model analysis under uncertainty, via a quick case study.</p></li>
</ul>
<p>The best way to use this book is to follow the Quick Start instructions below to install <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> and get familiar with the software.</p>
<div class="section" id="quick-start-with-py-grama">
<h2><span class="section-number">4.1. </span>Quick Start with <code class="docutils literal notranslate"><span class="pre">py-grama</span></code><a class="headerlink" href="#quick-start-with-py-grama" title="Permalink to this headline">#</a></h2>
<p>This Quick Start guide will take you through installing <code class="docutils literal notranslate"><span class="pre">py-grama</span></code>, loading in a simple model, and analyzing the model with some exploratory analysis tools. The purpose of this Quick Start is not to solve a scientific problem, but rather to introduce the <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> toolkit with a very simple model.</p>
<div class="section" id="install">
<h3><span class="section-number">4.1.1. </span>Install<a class="headerlink" href="#install" title="Permalink to this headline">#</a></h3>
<p id="index-1">Follow these instructions to install Python and the <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> package.</p>
<div class="section" id="install-anaconda-python">
<h4><span class="section-number">4.1.1.1. </span>Install Anaconda Python.<a class="headerlink" href="#install-anaconda-python" title="Permalink to this headline">#</a></h4>
<p id="index-2"><a class="reference external" href="https://www.anaconda.com/distribution/">Anaconda</a><a class="footnote-reference brackets" href="#anacondaurl" id="id1">1</a> is a way to install Python that includes many tools for scientific computing. We recommend starting from Anaconda to help take care of dependencies.</p>
<p>As an alternative to installing Anaconda on your computer, you can use a cloud-based computation system such as Google’s <a class="reference external" href="https://colab.research.google.com/">Colab</a>.</p>
</div>
<div class="section" id="use-the-python-package-manager-to-install-py-grama">
<h4><span class="section-number">4.1.1.2. </span>Use the Python package manager to install <code class="docutils literal notranslate"><span class="pre">py-grama</span></code>.<a class="headerlink" href="#use-the-python-package-manager-to-install-py-grama" title="Permalink to this headline">#</a></h4>
<p>Open your <a class="reference external" href="https://docs.anaconda.com/anaconda/user-guide/getting-started/#cli-hello">Anaconda prompt</a>, type the following line into your prompt, and hit Return (Enter).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install py-grama
</pre></div>
</div>
<p>This will automatically download Grama and install its dependencies.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Prompt vs. Python.</strong>
Throughout this book, we will use the symbol <code class="docutils literal notranslate"><span class="pre">$</span></code> to denote code you should run in your Anaconda prompt. This will be infrequent but important to notice!</p>
</div>
</div>
<div class="section" id="test-your-install">
<h4><span class="section-number">4.1.1.3. </span>Test your install.<a class="headerlink" href="#test-your-install" title="Permalink to this headline">#</a></h4>
<p>Start a Python terminal (Open <a class="reference external" href="https://docs.anaconda.com/anaconda/user-guide/getting-started/#cli-hello">Anaconda prompt</a>, and use the command <code class="docutils literal notranslate"><span class="pre">python</span></code>) and run the code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">grama</span> <span class="k">as</span> <span class="nn">gr</span>
</pre></div>
</div>
</div>
</div>
<p>If this runs without error, then you have successfully installed Grama!</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">gr</span><span class="o">.</span><span class="n">hide_traceback</span><span class="p">()</span> <span class="c1"># Shorten error traceback (for printed book)</span>
<span class="n">gr</span><span class="o">.</span><span class="n">set_uqtheme</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="jupyter-notebooks">
<h3><span class="section-number">4.1.2. </span>Jupyter Notebooks<a class="headerlink" href="#jupyter-notebooks" title="Permalink to this headline">#</a></h3>
<p id="index-3">Above, you ran Python code in a terminal; this is like using Python as a calculator but does not allow you to save your work. Python code is sometimes saved in scripts; these are machine-readable files with the <code class="docutils literal notranslate"><span class="pre">.py</span></code> extension. Scripts are great for reusable code, but we prefer Jupyter Notebooks for organizing studies involving equations, figures, and documentation.</p>
<p>Jupyter Notebooks are great for writing scientific reports. In fact, the chapters of this text were written as Jupyter notebooks <a class="footnote-reference brackets" href="#jb" id="id2">2</a>!</p>
<p>To start Jupyter, open your Anaconda prompt and run the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ jupyter lab
</pre></div>
</div>
<p>This will open a page in your web browser with the JupyterLab interface. The JupyterLab documentation has more information; in particular, overview page <a class="footnote-reference brackets" href="#overview-page" id="id3">3</a> has a good introduction to using Jupyter. We highly recommend watching at least an introductory tutorial to learn how to use Jupyter Notebooks.</p>
<div class="admonition-exercise-follow-along admonition">
<p class="admonition-title"><strong>Exercise: Follow along!</strong></p>
<p>To get the most out of this book, we <em>highly</em> recommend you follow along with this Quick Start! Fire up a Jupyter Notebook and try the commands discussed next.</p>
</div>
</div>
<div class="section" id="boilerplate-code">
<h3><span class="section-number">4.1.3. </span>Boilerplate code<a class="headerlink" href="#boilerplate-code" title="Permalink to this headline">#</a></h3>
<p id="index-4">To set up <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> in a Jupyter Notebook, you must run the following code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Boilerplate code for setting up py-grama</span>
<span class="kn">import</span> <span class="nn">grama</span> <span class="k">as</span> <span class="nn">gr</span>   <span class="c1"># This imports the py-grama package</span>
<span class="n">DF</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">Intention</span><span class="p">()</span>  <span class="c1"># This sets up the DataFrame &quot;pronoun&quot;</span>
<span class="c1"># The following allows graphs to be shown &quot;inline&quot; in Jupyter</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>This code loads <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> and sets up some key infrastructure for the package.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Package prefix.</strong>
Note that the call to <code class="docutils literal notranslate"><span class="pre">Intention()</span></code> uses the <code class="docutils literal notranslate"><span class="pre">gr</span></code> prefix we set with <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">grama</span> <span class="pre">as</span> <span class="pre">gr</span></code>. This is how we access all functions and objects in <code class="docutils literal notranslate"><span class="pre">py-grama</span></code>.</p>
</div>
<p>Next, we’ll go through a quick demo of <code class="docutils literal notranslate"><span class="pre">py-grama</span></code>.</p>
</div>
<div class="section" id="a-demo-model">
<span id="demo-model"></span><h3><span class="section-number">4.1.4. </span>A demo model<a class="headerlink" href="#a-demo-model" title="Permalink to this headline">#</a></h3>
<p>Run the following code to load a built-in <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> model and print a summary:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import a test model</span>
<span class="kn">from</span> <span class="nn">grama.models</span> <span class="kn">import</span> <span class="n">make_test</span>
<span class="c1"># Initialize the model</span>
<span class="n">md_test</span> <span class="o">=</span> <span class="n">make_test</span><span class="p">()</span>
<span class="c1"># Print a model summary</span>
<span class="n">md_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/zach/Git/py_grama/grama/marginals.py:338: RuntimeWarning: divide by zero encountered in double_scalars
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>model: (no name)

  inputs:
    var_det:
      x2: [-1, 1]

    var_rand:
      x0: (+0) uniform, {&#39;mean&#39;: &#39;0.000e+00&#39;, &#39;s.d.&#39;: &#39;5.800e-01&#39;, &#39;COV&#39;: inf, &#39;skew.&#39;: 0.0, &#39;kurt.&#39;: 1.8}
      x1: (+0) uniform, {&#39;mean&#39;: &#39;0.000e+00&#39;, &#39;s.d.&#39;: &#39;5.800e-01&#39;, &#39;COV&#39;: inf, &#39;skew.&#39;: 0.0, &#39;kurt.&#39;: 1.8}

    copula:
      Independence copula

  functions:
      f0: [&#39;x0&#39;, &#39;x1&#39;, &#39;x2&#39;] -&gt; [&#39;y0&#39;]
</pre></div>
</div>
</div>
</div>
<p>We’ll discuss these elements of a model more in later sections. For now, note that we have three inputs <code class="docutils literal notranslate"><span class="pre">['x0',</span> <span class="pre">'x1',</span> <span class="pre">'x2']</span></code> that map to one output <code class="docutils literal notranslate"><span class="pre">['y0']</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Code warnings.</strong>
Note that this code produces a <em>warning</em>, specifically a <code class="docutils literal notranslate"><span class="pre">RuntimeWarning</span></code>. In this case, the warning is due to a <code class="docutils literal notranslate"><span class="pre">divide</span> <span class="pre">by</span> <span class="pre">zero</span></code>, which is in turn due to a computation of the coefficient of variation (COV). Note that the COV values are <code class="docutils literal notranslate"><span class="pre">inf</span></code> in this model summary. Because the COV is computed as the standard deviation (s.d.) divided by the mean—and the mean is zero in this case—the COV is infinite.</p>
<p>Warnings are common when writing and running code. Sometimes these warnings provide useful information for interpreting results. Other times, warnings point to important issues that we should resolve.</p>
</div>
<p>We can get a sense for how the model behaves by sweeping over different values of the inputs one-at-a-time and visualizing the output values. One way to produce this kind of visual is to construct a <em>sinew plot</em>, discussed further in <a class="reference internal" href="../02_developing/ema.html#s-ema-sinews"><span class="std std-numref">Section 9.5.4.1</span></a>. The following code produces a sinew plot with the demo model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1"># Use the demo model</span>
    <span class="n">md_test</span>
    <span class="c1"># Generate data</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sinews</span><span class="p">(</span><span class="n">df_det</span><span class="o">=</span><span class="s2">&quot;swp&quot;</span><span class="p">)</span>
    <span class="c1"># Visualize the data</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_auto</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Calling plot_sinew_outputs....
</pre></div>
</div>
</div>
</div>
<p>To show a figure, we simply <code class="docutils literal notranslate"><span class="pre">print()</span></code> the plotted object:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/grama-intro_17_0.png" src="../_images/grama-intro_17_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/grama-intro_18_0.png" src="../_images/grama-intro_18_0.png" />
</div>
</div>
<div class="figure align-default" id="fig-grama-intro-sinew">
<p class="caption"><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Sinew plot generated from example model.</span><a class="headerlink" href="#fig-grama-intro-sinew" title="Permalink to this image">#</a></p>
</div>
<p>Note that the resulting plot (<strong><a class="reference internal" href="#fig-grama-intro-sinew"><span class="std std-numref">Figure 4.1</span></a></strong>) has three columns and one row; these correspond to the three inputs (columns and horizontal axes) and one output (rows and vertical axes). Each column of this plot shows a “sweep” over its inputs: a single input is varied while holding the other inputs constant, and the resulting values for the output are recorded. For instance, in the panel under <code class="docutils literal notranslate"><span class="pre">x0</span></code>, the input <code class="docutils literal notranslate"><span class="pre">x0</span></code> is varied while <code class="docutils literal notranslate"><span class="pre">x1</span></code> and <code class="docutils literal notranslate"><span class="pre">x2</span></code> are held constant. As model behavior can change depending on the held-constant inputs, the process repeats for a variety of starting conditions, resulting in multiple lines in each panel.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>All linear?</strong>
Interpreting the plot <strong><a class="reference internal" href="#fig-grama-intro-sinew"><span class="std std-numref">Figure 4.1</span></a></strong>, the output <code class="docutils literal notranslate"><span class="pre">y0</span></code> seems to be linear in all of its inputs: No matter where we start, moving along one of the inputs results in a linear trend for the output. Maybe we got lucky? With more sweeps, would we see a different result?</p>
</div>
</div>
<div class="section" id="overriding-the-defaults">
<h3><span class="section-number">4.1.5. </span>Overriding the defaults<a class="headerlink" href="#overriding-the-defaults" title="Permalink to this headline">#</a></h3>
<p id="index-5">The <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> package is designed to provide sensible defaults to get you started with each function, but you can override these defaults when necessary. For instance, the following code plots more sweeps by specifying the keyword argument <code class="docutils literal notranslate"><span class="pre">n_sweeps=4</span></code> (<strong><a class="reference internal" href="#fig-grama-sinew-param"><span class="std std-numref">Figure 4.2</span></a></strong>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">md_test</span>
    <span class="c1"># Generate data</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sinews</span><span class="p">(</span>
        <span class="n">df_det</span><span class="o">=</span><span class="s2">&quot;swp&quot;</span><span class="p">,</span>
        <span class="c1"># Generate more sweeps</span>
        <span class="n">n_sweeps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_auto</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Calling plot_sinew_outputs....
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/grama-intro_23_0.png" src="../_images/grama-intro_23_0.png" />
</div>
</div>
<div class="figure align-default" id="fig-grama-sinew-param">
<p class="caption"><span class="caption-number">Fig. 4.2 </span><span class="caption-text">A sinew plot generated from the demo model; note the increased number of sweeps (4).</span><a class="headerlink" href="#fig-grama-sinew-param" title="Permalink to this image">#</a></p>
</div>
<p>Note that more sweeps (larger <code class="docutils literal notranslate"><span class="pre">n_sweeps</span></code>) will tend to require more compute time <a class="footnote-reference brackets" href="#n-sweeps" id="id4">4</a> (<strong><a class="reference internal" href="#fig-grama-sinew-param"><span class="std std-numref">Figure 4.2</span></a></strong>). This might be easy to afford if your model is simple, but can be quite expensive as your model grows more complicated.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Not proven linear.</strong>
Interpreting the plot in <strong><a class="reference internal" href="#fig-grama-sinew-param"><span class="std std-numref">Figure 4.2</span></a></strong>, you can see that even with more sweeps the output <code class="docutils literal notranslate"><span class="pre">y0</span></code> still seems to be linear in all of its inputs. This doesn’t prove that <code class="docutils literal notranslate"><span class="pre">y0</span></code> is linear in all its inputs, but the evidence seems convincing for now.</p>
</div>
</div>
<div class="section" id="getting-help">
<h3><span class="section-number">4.1.6. </span>Getting help<a class="headerlink" href="#getting-help" title="Permalink to this headline">#</a></h3>
<p id="index-6">No programmer memorizes <em>everything</em> in a software package! Competent programmers regularly consult documentation to remind themselves how to use a function, or to learn about a new function.</p>
<p>Reading a function’s documentation can be overwhelming at first, but with practice you can quickly find a lot of useful information. In Python, you can use the <code class="docutils literal notranslate"><span class="pre">help()</span></code> command to get more information on a function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">eval_sinews</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on curry in module grama.eval_random:

eval_sinews(model=&#39;__no__default__&#39;, n_density=10, n_sweeps=3, seed=None, df_det=None, varname=&#39;sweep_var&#39;, indname=&#39;sweep_ind&#39;, append=True, skip=False)
    Sweep study
    
    Perform coordinate sweeps over each model random variable (&quot;sinew&quot; design). Use random starting points drawn from the joint density. Optionally sweep the deterministic variables.
    
    For more expensive models, it can be helpful to tune n_density and n_sweeps to achieve a reasonable runtime.
    
    Use gr.plot_auto() to construct a quick visualization of the output dataframe. Use `skip` version to visualize the design, and non-skipped version to visualize the results.
    
    Args:
        model (gr.Model): Model to evaluate
        n_density (numeric): Number of points along each sweep
        n_sweeps (numeric): Number of sweeps per-random variable
        seed (int): Random seed to use
        df_det (DataFrame): Deterministic levels for evaluation;
            use &quot;nom&quot; for nominal deterministic levels,
            use &quot;swp&quot; to sweep deterministic variables
        varname (str): Column name to give for sweep variable; default=&quot;sweep_var&quot;
        indname (str): Column name to give for sweep index; default=&quot;sweep_ind&quot;
        append (bool): Append results to conservative inputs?
        skip (bool): Skip evaluation of the functions?
    
    Returns:
        DataFrame: Results of evaluation or unevaluated design
    
    Examples::
    
        import grama as gr
        md = gr.make_cantilever_beam()
        # Skip evaluation, used to visualize the design (input points)
        df_design = md &gt;&gt; gr.ev_sinews(df_det=&quot;nom&quot;, skip=True)
        df_design &gt;&gt; gr.pt_auto()
        # Visualize the input-to-output relationships of the model
        df_sinew = md &gt;&gt; gr.ev_sinews(df_det=&quot;nom&quot;)
        df_sinew &gt;&gt; gr.pt_auto()
</pre></div>
</div>
</div>
</div>
<p>Let’s break down the information just presented:</p>
<ul class="simple">
<li><p>The line with <code class="docutils literal notranslate"><span class="pre">eval_sinews(...)</span></code> is the <em>function signature</em>; this shows the function with all of its possible arguments.</p></li>
<li><p>The paragraphs that follow the signature describe the function in plain language.</p></li>
<li><p>The lines under <code class="docutils literal notranslate"><span class="pre">Args</span></code> detail the arguments to the function. The lines are of the form <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">(type):</span> <span class="pre">Details</span></code>, where</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> is the name of the argument,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> is the expected datatype of the argument, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Details</span></code> follow in plain text. If an argument only takes particular values, the <code class="docutils literal notranslate"><span class="pre">Details</span></code> should tell you about this.</p></li>
</ul>
</li>
<li><p>The line under <code class="docutils literal notranslate"><span class="pre">Returns</span></code> details the returned object (if any), including its datatype.</p></li>
<li><p>Function documentation often includes <code class="docutils literal notranslate"><span class="pre">Examples</span></code>; look at this section for some real-code examples of the function’s use. This is particularly useful, as you can see what other objects and functions this tool is used with.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Accessing documentation in Jupyter.</strong>
Note that in Jupyter, you can quickly reference the documentation for a function by placing your cursor over a function you’d like to reference, and pressing the keys <code class="docutils literal notranslate"><span class="pre">Shift</span> <span class="pre">+</span> <span class="pre">Tab</span></code>. Try this in your own Jupyter Notebook.</p>
</div>
</div>
</div>
<div class="section" id="grama-concepts">
<h2><span class="section-number">4.2. </span>Grama Concepts<a class="headerlink" href="#grama-concepts" title="Permalink to this headline">#</a></h2>
<p>Now that we’ve seen how <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> works, let’s look closer at the concepts behind <code class="docutils literal notranslate"><span class="pre">py-grama</span></code>. The <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> package was designed around a few simple ideas: two primary kinds of objects (data and models) and four kinds of verbs.</p>
<div class="section" id="objects-data-and-models">
<h3><span class="section-number">4.2.1. </span>Objects: Data and models<a class="headerlink" href="#objects-data-and-models" title="Permalink to this headline">#</a></h3>
<div class="section" id="data-df">
<span id="index-7"></span><h4><span class="section-number">4.2.1.1. </span>Data (<code class="docutils literal notranslate"><span class="pre">df</span></code>).<a class="headerlink" href="#data-df" title="Permalink to this headline">#</a></h4>
<p>Data in <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> is organized into <a class="reference external" href="https://pandas.pydata.org/">Pandas</a> <strong>DataFrames</strong> <span id="id5">[<a class="reference internal" href="../zbib.html#id128">pandas development team, 2020</a>]</span>. A DataFrame is a digital table, with named columns that organize observations on variables. When using <code class="docutils literal notranslate"><span class="pre">py-grama</span></code>, the convention is to name your DataFrames with the <code class="docutils literal notranslate"><span class="pre">df_</span></code> prefix followed by a descriptive name, for instance <code class="docutils literal notranslate"><span class="pre">df_train</span></code> for a set of training data.</p>
<p>The code we saw under <a class="reference internal" href="#demo-model"><span class="std std-numref">Chapter 4.1.4</span></a> generated a DataFrame, that was then visualized using the <code class="docutils literal notranslate"><span class="pre">gr.pt_auto()</span></code> tool. If we disable the plotting line with a comment as follows, we can inspect the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_results</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">md_test</span>
    <span class="c1"># Generate data</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sinews</span><span class="p">(</span><span class="n">df_det</span><span class="o">=</span><span class="s2">&quot;swp&quot;</span><span class="p">)</span>
    <span class="c1"># The following line is commented;</span>
    <span class="c1"># the data will not be plotted</span>
<span class="c1">#     &gt;&gt; gr.pt_auto()</span>
<span class="p">)</span>
<span class="n">df_results</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x0</th>
      <th>x2</th>
      <th>sweep_var</th>
      <th>sweep_ind</th>
      <th>y0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.951066</td>
      <td>-1.000000</td>
      <td>-0.834548</td>
      <td>x0</td>
      <td>0</td>
      <td>-2.785613</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.951066</td>
      <td>-0.777778</td>
      <td>-0.834548</td>
      <td>x0</td>
      <td>0</td>
      <td>-2.563391</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.951066</td>
      <td>-0.555556</td>
      <td>-0.834548</td>
      <td>x0</td>
      <td>0</td>
      <td>-2.341169</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.951066</td>
      <td>-0.333333</td>
      <td>-0.834548</td>
      <td>x0</td>
      <td>0</td>
      <td>-2.118947</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.951066</td>
      <td>-0.111111</td>
      <td>-0.834548</td>
      <td>x0</td>
      <td>0</td>
      <td>-1.896724</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>85</th>
      <td>-0.733800</td>
      <td>-0.472779</td>
      <td>0.111111</td>
      <td>x2</td>
      <td>2</td>
      <td>-1.095467</td>
    </tr>
    <tr>
      <th>86</th>
      <td>-0.733800</td>
      <td>-0.472779</td>
      <td>0.333333</td>
      <td>x2</td>
      <td>2</td>
      <td>-0.873245</td>
    </tr>
    <tr>
      <th>87</th>
      <td>-0.733800</td>
      <td>-0.472779</td>
      <td>0.555556</td>
      <td>x2</td>
      <td>2</td>
      <td>-0.651023</td>
    </tr>
    <tr>
      <th>88</th>
      <td>-0.733800</td>
      <td>-0.472779</td>
      <td>0.777778</td>
      <td>x2</td>
      <td>2</td>
      <td>-0.428800</td>
    </tr>
    <tr>
      <th>89</th>
      <td>-0.733800</td>
      <td>-0.472779</td>
      <td>1.000000</td>
      <td>x2</td>
      <td>2</td>
      <td>-0.206578</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 6 columns</p>
</div></div></div>
</div>
<p>Note that the DataFrame <code class="docutils literal notranslate"><span class="pre">df_results</span></code> contains both numeric columns (such as <code class="docutils literal notranslate"><span class="pre">df_results.x1</span></code>) and string columns (such as <code class="docutils literal notranslate"><span class="pre">df_results.sweep_var</span></code>). We can also see some basic-but-useful facts, such as the size (90 rows x 6 columns).</p>
<p>Without some processing, data by itself cannot generate insights. We will see a variety of <em>transformation</em> verbs we can use in <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> to work with data, and we will use data to inform and fit models.</p>
<p>The data we work with can come from a physical experiment (loaded from disk) or from a simulation (generated by a model). Either way, it will be packaged in a Pandas DataFrame. This ensures we can use consistent tools to work with data, regardless of their origin.</p>
<p id="index-8"><em>Models (<code class="docutils literal notranslate"><span class="pre">md</span></code>)</em></p>
<p><strong>Models</strong> in <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> are represented by a special <code class="docutils literal notranslate"><span class="pre">gr.Model</span></code> Python class. A model is essentially a capsule containing functions that map inputs to outputs and information about the inputs. We saw some of this information summarized when we printed <code class="docutils literal notranslate"><span class="pre">md_test</span></code> previously, and again here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">md_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/zach/Git/py_grama/grama/marginals.py:338: RuntimeWarning: divide by zero encountered in double_scalars
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>model: (no name)

  inputs:
    var_det:
      x2: [-1, 1]

    var_rand:
      x0: (+0) uniform, {&#39;mean&#39;: &#39;0.000e+00&#39;, &#39;s.d.&#39;: &#39;5.800e-01&#39;, &#39;COV&#39;: inf, &#39;skew.&#39;: 0.0, &#39;kurt.&#39;: 1.8}
      x1: (+0) uniform, {&#39;mean&#39;: &#39;0.000e+00&#39;, &#39;s.d.&#39;: &#39;5.800e-01&#39;, &#39;COV&#39;: inf, &#39;skew.&#39;: 0.0, &#39;kurt.&#39;: 1.8}

    copula:
      Independence copula

  functions:
      f0: [&#39;x0&#39;, &#39;x1&#39;, &#39;x2&#39;] -&gt; [&#39;y0&#39;]
</pre></div>
</div>
</div>
</div>
<p>Reading these lines, we can see that the key information about the model is summarized as text:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">inputs</span></code> organize the model inputs into two categories:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">var_det</span></code> are the <em>deterministic</em> variables; these are assumed to be perfectly known, and must be set to run the model. Deterministic variables are reported with their bounds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">var_rand</span></code> are the <em>random</em> variables; these are assumed to be fundamentally unknowable, and can be sampled according to their distribution. Random variables are reported with their distribution type and parameters.</p></li>
</ul>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">copula</span></code> describes the relationship between random variables. In the example given, the random variables are assumed to be mutually independent.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">functions</span></code> list all of the mappings from inputs to outputs.</p>
<ul>
<li><p>The previous example has just one function <code class="docutils literal notranslate"><span class="pre">f0</span></code>, which maps all of its inputs to the single output <code class="docutils literal notranslate"><span class="pre">y0</span></code>.</p></li>
</ul>
</li>
</ul>
<p>In <code class="docutils literal notranslate"><span class="pre">py-grama</span></code>, models are used to represent scenarios with quantified uncertainties. We can use models to run simulations (generate simulated data), to propagate uncertainty, or even as a template to fit a model to data.</p>
</div>
</div>
<div class="section" id="verbs-four-fundamental-verbs">
<h3><span class="section-number">4.2.2. </span>Verbs: Four fundamental verbs<a class="headerlink" href="#verbs-four-fundamental-verbs" title="Permalink to this headline">#</a></h3>
<p id="index-9">The <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> package focuses on data and model objects, and provides four kinds of <strong>verbs</strong> that inter-relate the two object types. The relationship between these objects and verbs constitutes the <em>grammar</em> of this grammar of model analysis.</p>
<p>In short, the four verbs relate data and models according to <strong><a class="reference internal" href="#fig-verb-classes"><span class="std std-numref">Figure 4.3</span></a></strong>.</p>
<div class="figure align-default" id="fig-verb-classes">
<a class="reference internal image-reference" href="../_images/verb-classes-bw.png"><img alt="Verb classes" src="../_images/verb-classes-bw.png" style="width: 75%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.3 </span><span class="caption-text">The <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> verbs, as they relate to data and models.</span><a class="headerlink" href="#fig-verb-classes" title="Permalink to this image">#</a></p>
</div>
<p>In greater detail, the four verbs are:</p>
<ul class="simple">
<li><p>To <strong>transform</strong> (<code class="docutils literal notranslate"><span class="pre">tf</span></code>) is to modify one DataFrame into another DataFrame. Some examples include making simple calculations (like converting from Fahrenheit to Celsius), reshaping a dataset, converting from one datatype to another, and so on.</p></li>
<li><p>To <strong>evaluate</strong> (<code class="docutils literal notranslate"><span class="pre">ev</span></code>) is to use a model to generate a DataFrame. Evaluation routines are used to run a variety of simulations, such as a simple planned run (<code class="docutils literal notranslate"><span class="pre">gr.ev_df()</span></code>), a Monte Carlo simulation (<code class="docutils literal notranslate"><span class="pre">gr.ev_sample()</span></code>), or a more advanced reliability-assessment technique (e.g. <code class="docutils literal notranslate"><span class="pre">gr.ev_form_pma()</span></code>).</p></li>
<li><p>To <strong>fit</strong> (<code class="docutils literal notranslate"><span class="pre">ft</span></code>) is to use a training DataFrame to generate a model. We could start with a user-defined model and fit its free parameters (<code class="docutils literal notranslate"><span class="pre">gr.ft_nls()</span></code>), or use a purely empirical approach to modeling the data (e.g. <code class="docutils literal notranslate"><span class="pre">gr.ft_gp()</span></code>).</p></li>
<li><p>To <strong>compose</strong> (<code class="docutils literal notranslate"><span class="pre">cp</span></code>) is to modify an existing model and return a new model. Composition routines are generally used in the model-building phase of a study, though we can also use them to make small adjustments to a model.</p></li>
</ul>
<p>Like any language, there are also some exceptional verbs:</p>
<ul class="simple">
<li><p>Plotting routines (<code class="docutils literal notranslate"><span class="pre">pt</span></code>) are used to visualize data. You are of course free to plot your data however you like, but know that the magic <code class="docutils literal notranslate"><span class="pre">gr.pt_auto()</span></code> routine is available to provide a quick visualization for many of the outputs of <code class="docutils literal notranslate"><span class="pre">ev</span></code> verbs.</p></li>
</ul>
<p><strong><a class="reference internal" href="#tab-verbs"><span class="std std-numref">Table 4.1</span></a></strong> summarizes the verbs in terms of their prefixes and input-output datatypes.</p>
<table class="colwidths-auto table" id="tab-verbs">
<caption><span class="caption-number">Table 4.1 </span><span class="caption-text">Table of verbs and prefixes.</span><a class="headerlink" href="#tab-verbs" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Verb</strong></p></th>
<th class="head"><p><strong>Short</strong></p></th>
<th class="head"><p><strong>In</strong></p></th>
<th class="head"><p><strong>Out</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tran_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tf_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">eval_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ev_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">md</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fit_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ft_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">md</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">comp_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cp_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">md</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">md</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">plot_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pt_</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">df</span></code></p></td>
<td><p>–</p></td>
</tr>
</tbody>
</table>
<p>Complex activities such as verification and validation (<a class="reference internal" href="modeling-process.html#vnv"><span class="std std-numref">Chapter 3.6</span></a>) can be understood as working with both data and models. The <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> package provides a consistent syntax for implementing complex activities in terms of fundamental verbs. For instance, validating a model requires that we compare model outputs with experimentally measured values. To do so, we must first fit (<code class="docutils literal notranslate"><span class="pre">fit_</span></code>) the model to match the experimental settings, then evaluate (<code class="docutils literal notranslate"><span class="pre">eval_</span></code>) the model using validation-grade data to compare against the experimental results.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Recognizing a new verb.</strong>
The verb prefixes <code class="docutils literal notranslate"><span class="pre">tran_</span></code> (<code class="docutils literal notranslate"><span class="pre">tf_</span></code>), <code class="docutils literal notranslate"><span class="pre">eval_</span></code> (<code class="docutils literal notranslate"><span class="pre">ev_</span></code>), <code class="docutils literal notranslate"><span class="pre">fit_</span></code> (<code class="docutils literal notranslate"><span class="pre">ft_</span></code>), and <code class="docutils literal notranslate"><span class="pre">comp_</span></code> (<code class="docutils literal notranslate"><span class="pre">cp_</span></code>) are <em>signifiers</em> that help you recognize something about a verb just by looking at it. Remember that the prefix will tell you the type of the verb’s first input, and the type of its return value.</p>
</div>
</div>
<div class="section" id="functional-programming">
<span id="grama-functional"></span><h3><span class="section-number">4.2.3. </span>Functional programming<a class="headerlink" href="#functional-programming" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> package also provides some special syntax for <strong>functional programming</strong>-style computational pipelines. One of the advantages of this style of programming is that we can eliminate intermediate variable names. For instance, consider the following <em>imperative</em>-style code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Build the model</span>
<span class="c1"># Initialize an empty model</span>
<span class="n">md_temporary</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;Temporary model&quot;</span><span class="p">)</span>
<span class="c1"># Add a function to the model</span>
<span class="n">md_temporary</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">comp_function</span><span class="p">(</span>
    <span class="n">md_temporary</span><span class="p">,</span>
    <span class="c1"># Use an inline (lambda) function</span>
    <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">:</span> <span class="n">x0</span> <span class="o">*</span> <span class="n">x1</span><span class="p">,</span>
    <span class="n">var</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">out</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
<span class="c1"># Add some bounds for the inputs</span>
<span class="n">md_temporary</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">comp_bounds</span><span class="p">(</span>
    <span class="n">md_temporary</span><span class="p">,</span>
    <span class="n">x0</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">x1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1">## Generate results</span>
<span class="n">df_temporary</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">eval_sinews</span><span class="p">(</span>
    <span class="n">md_temporary</span><span class="p">,</span>
    <span class="n">df_det</span><span class="o">=</span><span class="s2">&quot;swp&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1">## Visualize (Note: Not executed for space)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">plot_auto</span><span class="p">(</span><span class="n">df_temporary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Calling plot_sinew_outputs....
</pre></div>
</div>
</div>
</div>
<p>Note to write this code, we had to assign the model (<code class="docutils literal notranslate"><span class="pre">md_temporary</span></code>) and output data (<code class="docutils literal notranslate"><span class="pre">df_temporary</span></code>) to variables, in order to write the code. This is somewhat, as we are only setting up the model and data to generate a single plot.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Inline (lambda) functions.</strong>
The <code class="docutils literal notranslate"><span class="pre">lambda</span></code> keyword just used might be unfamiliar. This is a way to define an <em>inline function</em> in Python. Effectively, the <code class="docutils literal notranslate"><span class="pre">lambda</span></code> keyword is a compact way to define a function. For a <code class="docutils literal notranslate"><span class="pre">lambda</span></code> function, the symbols before the colon are function inputs, while the expression following the colon defines the return value.</p>
</div>
<p>Now compare with the following <em>functional-style</em> code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1">## Build the model</span>
    <span class="c1"># Initialize an empty model</span>
    <span class="n">gr</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;Temporary model&quot;</span><span class="p">)</span>
    <span class="c1"># Add a function</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_function</span><span class="p">(</span>
        <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">:</span> <span class="n">x0</span> <span class="o">*</span> <span class="n">x1</span><span class="p">,</span>
        <span class="n">var</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">out</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Add some bounds</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_bounds</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="c1">## Evaluate the model</span>
    <span class="c1"># Generate data</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sinews</span><span class="p">(</span><span class="n">df_det</span><span class="o">=</span><span class="s2">&quot;swp&quot;</span><span class="p">)</span>
    <span class="c1"># Visualize the data</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_auto</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Calling plot_sinew_outputs....
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/grama-intro_43_0.png" src="../_images/grama-intro_43_0.png" />
</div>
</div>
<div class="figure align-default" id="fig-grama-vis-functional">
<p class="caption"><span class="caption-number">Fig. 4.4 </span><span class="caption-text">Sinew plot generated using functional programming-style code.</span><a class="headerlink" href="#fig-grama-vis-functional" title="Permalink to this image">#</a></p>
</div>
<p>Note that both the imperative and functional versions of the code will produce identical figures (e.g., <strong><a class="reference internal" href="#fig-grama-vis-functional"><span class="std std-numref">Figure 4.4</span></a></strong>). The functional-style code is more compact and does not require us to set intermediate variable names. However, it can be confusing to read at first.</p>
<p>One idea that helps make functional-style code more readable is to think of the <em>pipe operator</em> <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> as the phrase “and then.” This makes the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">gr</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_function</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_bounds</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sinews</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>read more like natural language:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">Create</span> <span class="n">a</span> <span class="n">model</span>
    <span class="ow">and</span> <span class="n">then</span> <span class="n">compose</span> <span class="k">with</span> <span class="n">a</span> <span class="n">function</span>
    <span class="ow">and</span> <span class="n">then</span> <span class="n">compose</span> <span class="k">with</span> <span class="n">bounds</span>
    <span class="ow">and</span> <span class="n">then</span> <span class="n">evaluate</span> <span class="n">sinews</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Short prefixes for functional-style code.</strong>
Note also that the short two-letter prefixes (e.g. <code class="docutils literal notranslate"><span class="pre">ev_</span></code>) are used for functional-style code, as opposed to the long forms of the prefix (e.g. <code class="docutils literal notranslate"><span class="pre">eval_</span></code>). If you find that your code throws errors, make sure you’re using the correct form of the prefix.</p>
</div>
</div>
<div class="section" id="more-on-py-grama">
<h3><span class="section-number">4.2.4. </span>More on <code class="docutils literal notranslate"><span class="pre">py-grama</span></code><a class="headerlink" href="#more-on-py-grama" title="Permalink to this headline">#</a></h3>
<p>This concludes the brief explanation of <code class="docutils literal notranslate"><span class="pre">py-grama</span></code>. For more information, you can read the official documentation, hosted at <a class="reference external" href="https://py-grama.readthedocs.io/en/latest/">https://py-grama.readthedocs.io/en/latest/</a>. <a class="reference internal" href="#grama-brief"><span class="std std-numref">Chapter 4.3</span></a> illustrates how <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> can be used for engineering applications.</p>
</div>
</div>
<div class="section" id="a-brief-case-study-assessing-structural-safety">
<span id="grama-brief"></span><h2><span class="section-number">4.3. </span>A Brief Case Study: Assessing Structural Safety<a class="headerlink" href="#a-brief-case-study-assessing-structural-safety" title="Permalink to this headline">#</a></h2>
<p>We wrap up this chapter with an example of using <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> to analyze the response of a metal plate to applied forces (“loads”). Specifically, we are interested in assessing the structural integrity of the plate when it is subject to compressive (inward) loads. Plates are common in many kinds of structures; for instance, the skin of an airplane wing is designed to take some of the bending loads due to lift generation. If one of these skin panels <em>buckles</em>, it will crumple and potentially lead to unsafe deformation of the wing.</p>
<p><strong><a class="reference internal" href="#fig-grama-plate-schematic"><span class="std std-numref">Figure 4.5</span></a></strong> depicts a thin plate subject to a compressive load. Using simple physical arguments and assuming fixed geometric and material properties, we can predict the maximum load <span class="math notranslate nohighlight">\(L\)</span> the plate can carry.</p>
<!-- ![](../images/plate-schematic.png) -->
<div class="figure align-default" id="fig-grama-plate-schematic">
<a class="reference internal image-reference" href="../_images/plate-schematic.png"><img alt="Schematic depiction of the flat plate, subject to a buckling load" src="../_images/plate-schematic.png" style="width: 35%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.5 </span><span class="caption-text">A schematic depiction of a flat plate subject to a buckling load.</span><a class="headerlink" href="#fig-grama-plate-schematic" title="Permalink to this image">#</a></p>
</div>
<p>However, variability in manufacturing means no two plates will perform exactly the same. While it would be possible in principle to inspect every plate to determine its buckling strength, it would not be feasible to carry out this testing on every manufactured plate. This lack of information means there is uncertainty associated with every plate. We will analyze the safety of plates under buckling conditions by performing a reliability analysis—assessing the probability of failure.</p>
<p>All scientific and engineering projects should have some sort of <strong>goal</strong>; the case studies in this book are no different.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Goals for this case study.</strong>
In studying these plates, our <strong>goal</strong> is to determine an appropriate thickness of plate that will support the desired compressive load of 1 ksi with a low chance of buckling. For this study, we seek a failure rate of less than 1 in a 100 (<strong><a class="reference internal" href="#fig-grama-schematic-rare"><span class="std std-numref">Figure 4.6</span></a></strong>).</p>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hidden input</span>
<span class="c1"># Make &quot;1 in 100&quot; schematic</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">gr</span><span class="o">.</span><span class="n">df_grid</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span>
        <span class="n">failed</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">if_else</span><span class="p">(</span>
            <span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span>
            <span class="kc">True</span><span class="p">,</span>
            <span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ggplot</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">aes</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">geom_point</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">aes</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s2">&quot;failed&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;failed&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;failed&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">scale_shape_manual</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s2">&quot;.&quot;</span><span class="p">})</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">scale_size_manual</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">})</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">theme_void</span><span class="p">()</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">theme</span><span class="p">(</span><span class="n">figure_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">plot_background</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">element_rect</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">guides</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;One Failure in 100&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../_images/grama-intro_51_0.png"><img alt="../_images/grama-intro_51_0.png" class="align-center" src="../_images/grama-intro_51_0.png" style="width: 75%;" /></a>
</div>
</div>
<div class="figure align-default" id="fig-grama-schematic-rare">
<p class="caption"><span class="caption-number">Fig. 4.6 </span><span class="caption-text">A visual depiction of 1 in 100. While we can’t guarantee <em>which</em> outcome will fail, we can be confident that only around 1 in 100 of these built objects will fail. This is a desirable outcome in manufacturing: to minimize the <em>probability of failure</em>.</span><a class="headerlink" href="#fig-grama-schematic-rare" title="Permalink to this image">#</a></p>
</div>
<p>First, we set up the case study by importing some data on aluminum plate material properties and loading a package to visualize the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grama.data</span> <span class="kn">import</span> <span class="n">df_stang</span> <span class="c1"># Dataset for modeling</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Representative data.</strong>
In order for data to be appropriate for our study, they must be <strong>representative</strong> of the manufacturing process we will use to produce the plates. (They can’t just be any old data!) In this case study, we will assume the data come from our desired manufacturing process.</p>
</div>
<p>Let’s inspect the data we just loaded.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_stang</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>thick</th>
      <th>alloy</th>
      <th>E</th>
      <th>mu</th>
      <th>ang</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.022</td>
      <td>al_24st</td>
      <td>10600</td>
      <td>0.321</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.022</td>
      <td>al_24st</td>
      <td>10600</td>
      <td>0.323</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.032</td>
      <td>al_24st</td>
      <td>10400</td>
      <td>0.329</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.032</td>
      <td>al_24st</td>
      <td>10300</td>
      <td>0.319</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.064</td>
      <td>al_24st</td>
      <td>10500</td>
      <td>0.323</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.064</td>
      <td>al_24st</td>
      <td>10700</td>
      <td>0.328</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These are observations on the elasticity <code class="docutils literal notranslate"><span class="pre">E</span></code> (ksi) and Poisson’s ratio <code class="docutils literal notranslate"><span class="pre">mu</span></code> (-) of a rolled aluminum alloy, with multiple specimens prepared and tested <span id="id6">[<a class="reference internal" href="../zbib.html#id73">Stang <em>et al.</em>, 1946</a>]</span>. Elasticity is a measure of the “stiffness” of a material <a class="footnote-reference brackets" href="#stretch" id="id7">5</a>; the higher the <code class="docutils literal notranslate"><span class="pre">E</span></code> value, the more force it takes to stretch the part. The Poisson’s ratio is sometimes called the volume contraction ratio; for example, when stretching a rubber band, the band will tend to get thinner in the middle. The Poisson’s ratio of a material determines how much thinner a part will tend to get when stretched. These two properties affect the buckling strength of a plate; we’ll see this when we study the buckling equation in <a class="reference internal" href="#grama-building"><span class="std std-numref">Chapter 4.3.1</span></a>.</p>
<p>However, before we study buckling, we will use these data to build a model for the <em>uncertainty</em> in the material properties.</p>
<div class="section" id="building-the-model">
<span id="grama-building"></span><h3><span class="section-number">4.3.1. </span>Building the model<a class="headerlink" href="#building-the-model" title="Permalink to this headline">#</a></h3>
<p>When building a model from data, we should first inspect the data to make sure they are trustworthy. This process will help us check our assumptions and data quality.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Properties are thickness-independent?</strong>
Material properties such as elasticity and the Poisson ratio are generally thought to be thickness-independent. If this is the case, then we don’t need to worry too much about relating the material properties to the chosen plate thickness, which will greatly simplify modeling. However, we should check this assumption using our data.</p>
</div>
<p>The plot in <strong><a class="reference internal" href="#fig-grama-vis-alloys"><span class="std std-numref">Figure 4.7</span></a></strong> shows the Poisson’s ratio against elasticity, with the thickness of each specimen denoted by the shapes of the points. Note that this plot is made using <code class="docutils literal notranslate"><span class="pre">gr.ggplot()</span></code>, which is discussed in <a class="reference internal" href="data-tools.html#data-ggplot"><span class="std std-numref">Chapter 5.2</span></a>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hidden input</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_stang</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">thick</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">as_str</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">thick</span><span class="p">))</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ggplot</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">aes</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;thick&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">scale_color_brewer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Thickness (in)&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;qual&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">theme_uqbook</span><span class="p">()</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">labs</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Elasticity (ksi)&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Poisson&#39;s Ratio (-)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/grama-intro_60_0.png" src="../_images/grama-intro_60_0.png" />
</div>
</div>
<div class="figure align-default" id="fig-grama-vis-alloys">
<p class="caption"><span class="caption-number">Fig. 4.7 </span><span class="caption-text">Material properties for aluminum plates of different thicknesses. Note that the thickest plates tend to be “separated” with lower <code class="docutils literal notranslate"><span class="pre">mu</span></code> and <code class="docutils literal notranslate"><span class="pre">E</span></code> values.</span><a class="headerlink" href="#fig-grama-vis-alloys" title="Permalink to this image">#</a></p>
</div>
<p><strong><a class="reference internal" href="#fig-grama-vis-alloys"><span class="std std-numref">Figure 4.7</span></a></strong> implies that the material properties are <em>not</em> thickness-independent! However, if we dig into the context of the data further, we will find that the measurements of the thickest plates are suspicious.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Outliers.</strong>
Based on <strong><a class="reference internal" href="#fig-grama-vis-alloys"><span class="std std-numref">Figure 4.7</span></a></strong>, the specimens of thickness <code class="docutils literal notranslate"><span class="pre">0.081</span></code> (in) are suspicious; these observations are well-separated from all the other cases. Reviewing the original publication that reported these data <span id="id8">[<a class="reference internal" href="../zbib.html#id73">Stang <em>et al.</em>, 1946</a>]</span>, it turns out that the thickest specimens were characterized with a different measurement procedure than the thinner specimens. This suggests that the measurements of the thickest specimens might not be compatible with the measurements of the thinnest specimens.</p>
</div>
<p>Let’s filter out the thickest specimens (<strong><a class="reference internal" href="#fig-grama-vis-alloys-filtered"><span class="std std-numref">Figure 4.8</span></a></strong>) and see if the remaining observations are relatively consistent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_filtered</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_stang</span>
    <span class="c1"># Keep only those plates thinner than 0.081 in</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_filter</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">thick</span> <span class="o">&lt;</span> <span class="mf">0.081</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hidden input</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_filtered</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">thick</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">as_str</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">thick</span><span class="p">))</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ggplot</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">aes</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;thick&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">scale_color_brewer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Thickness (in)&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;qual&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">theme_uqbook</span><span class="p">()</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">labs</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Elasticity (ksi)&quot;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Poisson&#39;s Ratio (-)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/grama-intro_65_0.png" src="../_images/grama-intro_65_0.png" />
</div>
</div>
<div class="figure align-default" id="fig-grama-vis-alloys-filtered">
<p class="caption"><span class="caption-number">Fig. 4.8 </span><span class="caption-text">Material properties for aluminum plates of different thicknesses, with the thickest plates removed. Among the remaining plates, the observations seem to have a similar spread.</span><a class="headerlink" href="#fig-grama-vis-alloys-filtered" title="Permalink to this image">#</a></p>
</div>
<p>The remaining observations shown in <strong><a class="reference internal" href="#fig-grama-vis-alloys-filtered"><span class="std std-numref">Figure 4.8</span></a></strong> are fairly consistent, even across different thicknesses . Given what we know, we will move forward by ignoring the thickest specimen data and limiting our attention to the plates studied in the remaining data. This leaves us with plates roughly between 1/48” and 1/16” in thickness.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Talk to experts!</strong>
If we were in the business of manufacturing plates, this would be an <em>excellent</em> time to go have a chat with the materials and process engineers about their experiments. We would ask about the two different characterization procedures, and ask for their opinion on how to use the data to inform our structural reliability analysis. We assumed the thickest specimens were less trustworthy, but their expert opinion might be different.</p>
</div>
<p>Now that we have a subset of data that we <em>trust</em>, we can proceed to build a probabilistic model for the uncertainty in material properties. As we’ll see in <a class="reference internal" href="../02_developing/propagation-algorithms.html#s-propagation-algorithms"><span class="std std-numref">Section 9.4</span></a>, we will need a model (rather than just data) to study the very small failure probabilities that we seek. The following code fits a joint distribution for <code class="docutils literal notranslate"><span class="pre">E,</span> <span class="pre">mu</span></code> based on the filtered data: A joint distribution is composed of <strong>marginal distributions</strong> (<a class="reference internal" href="../02_developing/marginals.html#s-marginals"><span class="std std-numref">Section 7.1</span></a>) and a <strong>dependency structure</strong> (<a class="reference internal" href="../02_developing/dependency.html#s-dependency"><span class="std std-numref">Section 7.2</span></a>). A marginal quantitatively describes the uncertainty in a single quantity, while dependency refers to how multiple uncertainties are related.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build an aluminum material property model</span>
<span class="n">md_aluminum</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">gr</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;Plate aluminum material properties&quot;</span><span class="p">)</span>
    <span class="c1"># Add marginals for each uncertain input</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_marginals</span><span class="p">(</span>
        <span class="n">E</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">marg_fit</span><span class="p">(</span><span class="s2">&quot;lognorm&quot;</span><span class="p">,</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">E</span><span class="p">),</span>
        <span class="n">mu</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">marg_fit</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">mu</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="c1"># Add a copula to define the dependency</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_copula_gaussian</span><span class="p">(</span><span class="n">df_data</span><span class="o">=</span><span class="n">df_filtered</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">md_aluminum</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>model: Plate aluminum material properties

  inputs:
    var_det:

    var_rand:
      E: (+0) lognorm, {&#39;mean&#39;: &#39;1.398e+23&#39;, &#39;s.d.&#39;: &#39;3.662e+45&#39;, &#39;COV&#39;: 2.620351106053833e+22, &#39;skew.&#39;: 1.7991959366176194e+67, &#39;kurt.&#39;: 2.2226746565162602e+179}
      mu: (+0) beta, {&#39;mean&#39;: &#39;3.300e-01&#39;, &#39;s.d.&#39;: &#39;1.000e-02&#39;, &#39;COV&#39;: 0.02, &#39;skew.&#39;: -1.81, &#39;kurt.&#39;: 6.859999999999999}

    copula:
      Gaussian copula with correlations:
  var1 var2      corr
0   mu    E  0.103376

  functions:
</pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>A reasonable fit?</strong>
We chose a couple of marginal distribution shapes above: lognormal for <code class="docutils literal notranslate"><span class="pre">E</span></code> and beta for <code class="docutils literal notranslate"><span class="pre">mu</span></code>. How well do these choices represent the original data?</p>
</div>
<p>To assess the model fit, we visualize the original experimental data against simulated realizations from our distribution model (<strong><a class="reference internal" href="#fig-grama-vis-model1"><span class="std std-numref">Figure 4.9</span></a></strong>).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hidden input</span>
<span class="c1"># Import tools to plot with scientific labels</span>
<span class="kn">from</span> <span class="nn">mizani.formatters</span> <span class="kn">import</span> <span class="n">scientific_format</span>

<span class="n">p</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">md_aluminum</span>
    <span class="c1">## Draw realizations from distribution</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">df_det</span><span class="o">=</span><span class="s2">&quot;nom&quot;</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">&quot;Simulated&quot;</span><span class="p">)</span>
    <span class="c1">## Add in the experimental data</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_bind_rows</span><span class="p">(</span>
        <span class="n">df_filtered</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1">## Compare the synthetic and experimental data</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ggplot</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">aes</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;source&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">geom_point</span><span class="p">()</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">scale_x_continuous</span><span class="p">(</span>
        <span class="n">breaks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e14</span><span class="p">,</span> <span class="mf">2e14</span><span class="p">],</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">scientific_format</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">scale_color_manual</span><span class="p">(</span>
        <span class="n">values</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">Experimental</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">Simulated</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Source&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">theme_uqbook</span><span class="p">()</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Elasticity (ksi)&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Poisson&#39;s Ratio (-)&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model V1&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eval_sample() is rounding n...
Estimated runtime: 0.0000 sec
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/grama-intro_72_0.png" src="../_images/grama-intro_72_0.png" />
</div>
</div>
<div class="figure align-default" id="fig-grama-vis-model1">
<p class="caption"><span class="caption-number">Fig. 4.9 </span><span class="caption-text">Simulated material property values from the first version of our model. There are extreme outliers in the simulated data that do not appear in the original data. Note that <code class="docutils literal notranslate"><span class="pre">e+14</span></code> means <span class="math notranslate nohighlight">\(\times 10^{14}\)</span>.</span><a class="headerlink" href="#fig-grama-vis-model1" title="Permalink to this image">#</a></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Extreme outliers in elasticity!</strong>
The chosen shape for the elasticity <code class="docutils literal notranslate"><span class="pre">E</span></code> produces extreme outliers that do not appear in the original data (<strong><a class="reference internal" href="#fig-grama-vis-model1"><span class="std std-numref">Figure 4.9</span></a></strong>). We have no evidence to support such extreme tail behavior. Therefore, we should change the marginal for <code class="docutils literal notranslate"><span class="pre">E</span></code>.</p>
</div>
<p>Let’s update the model to use a marginal shape for <code class="docutils literal notranslate"><span class="pre">E</span></code> with less extreme tail behavior. We then repeat the visual comparison to check our updated model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">md_aluminum_v2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">gr</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;Plate aluminum material properties&quot;</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_marginals</span><span class="p">(</span>
        <span class="c1"># Change the marginal for E to a normal</span>
        <span class="n">E</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">marg_fit</span><span class="p">(</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">E</span><span class="p">),</span>
        <span class="n">mu</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">marg_fit</span><span class="p">(</span><span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">mu</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_copula_gaussian</span><span class="p">(</span><span class="n">df_data</span><span class="o">=</span><span class="n">df_filtered</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hidden input and output</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">md_aluminum_v2</span>
    <span class="c1">## Draw realizations from distribution</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">df_det</span><span class="o">=</span><span class="s2">&quot;nom&quot;</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">&quot;Simulated&quot;</span><span class="p">)</span>
    <span class="c1">## Add in the experimental data</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_bind_rows</span><span class="p">(</span>
        <span class="n">df_filtered</span>
        <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">&quot;Experimental&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="c1">## Compare the synthetic and experimental data</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ggplot</span><span class="p">(</span><span class="n">gr</span><span class="o">.</span><span class="n">aes</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;source&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">geom_point</span><span class="p">()</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">scale_color_manual</span><span class="p">(</span>
        <span class="n">values</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">Experimental</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">Simulated</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Data Source&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">theme_uqbook</span><span class="p">()</span>
    <span class="o">+</span> <span class="n">gr</span><span class="o">.</span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Elasticity (ksi)&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Poisson&#39;s Ratio (-)&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model V2&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eval_sample() is rounding n...
Estimated runtime: 0.0000 sec
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/grama-intro_77_0.png" src="../_images/grama-intro_77_0.png" />
</div>
</div>
<div class="figure align-default" id="fig-grama-vis-model2">
<p class="caption"><span class="caption-number">Fig. 4.10 </span><span class="caption-text">Simulated material property values from the second version of our model. This version does not produce the extreme outliers, which better matches the experimental data.</span><a class="headerlink" href="#fig-grama-vis-model2" title="Permalink to this image">#</a></p>
</div>
<p>The results of <strong><a class="reference internal" href="#fig-grama-vis-model2"><span class="std std-numref">Figure 4.10</span></a></strong> look much more reasonable! The simulated and experimental data exhibit much more similar variability.</p>
<p>Now that we have a reasonable model for the material properties, we can turn our attention to mapping these inputs to the buckling behavior of the plate. Buckling is analyzed in terms of the <em>critical buckling stress</em> <span class="math notranslate nohighlight">\(\sigma\)</span> of a particular part. The larger this stress, the greater capacity the part has to withstand a buckling load.</p>
<p>The critical buckling stress for a plate in compression (with free edges) is a classic result of structural mechanics <span id="id9">[<a class="reference internal" href="../zbib.html#id79">Peery, 2011</a>]</span>, given by</p>
<div class="math notranslate nohighlight">
\[\sigma_{\text{buckling}} = k_{cr} \frac{\pi^2 E}{12(1 - \mu^2)} \left(\frac{t}{h}\right)^2\]</div>
<p>with <span class="math notranslate nohighlight">\(k_{cr} = (\frac{mh}{w} + \frac{w}{mh})^2\)</span>, and symbols defined in the <strong><a class="reference internal" href="#tab-plate-var"><span class="std std-numref">Table 4.2</span></a></strong>.</p>
<table class="colwidths-auto table" id="tab-plate-var">
<caption><span class="caption-number">Table 4.2 </span><span class="caption-text">Variables for the buckling plate model.</span><a class="headerlink" href="#tab-plate-var" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Symbol</strong></p></th>
<th class="head"><p><strong>Meaning</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(E\)</span></p></td>
<td><p>Aluminum elasticity</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mu\)</span></p></td>
<td><p>Aluminum Poisson ratio</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(t\)</span></p></td>
<td><p>Plate thickness</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(h\)</span></p></td>
<td><p>Plate height</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(w\)</span></p></td>
<td><p>Plate width</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>Buckling wavenumber</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\sigma_{\text{buckling}}\)</span></p></td>
<td><p>Buckling stress</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Anticipate your sanity checks.</strong>
Based on the buckling equation just given—and based on general physical intuition—we should have some expectations about the output’s behavior with its inputs. For instance, we would expect the buckling stress to get larger with a larger thickness: A thicker plate is harder to buckle. Conversely, we would expect a longer plate to buckle more easily, leading to a smaller buckling stress.</p>
</div>
<p>We can implement this function and add it to our <code class="docutils literal notranslate"><span class="pre">py-grama</span></code> model. The following code does this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build upon the material property model to add</span>
<span class="c1"># functions for the structural response</span>
<span class="n">md_plate</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1"># Start with the material property model we developed</span>
    <span class="n">md_aluminum_v2</span>
    <span class="c1"># Add the buckling strength equation</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_vec_function</span><span class="p">(</span>
        <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
            <span class="n">sigma_buckle</span>
              <span class="o">=</span><span class="mf">3.14159</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">E</span>
              <span class="o">/</span> <span class="mi">12</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
              <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># NB. Typo here!</span>
              <span class="o">*</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">m</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">h</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">w</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">w</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">m</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">h</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>          
        <span class="p">),</span>
        <span class="n">var</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">],</span>
        <span class="n">out</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sigma_buckle&quot;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Buckling strength&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Add bounds for deterministic inputs</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_bounds</span><span class="p">(</span>
        <span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="c1"># Consider a range</span>
        <span class="n">w</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="c1"># Assume constrained by design</span>
        <span class="n">m</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="c1"># Assume first mode dominates</span>
        <span class="c1"># Based on tested plate thicknesses</span>
        <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">48</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">md_plate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>model: Plate aluminum material properties

  inputs:
    var_det:
      m: [1, 1]
      h: [2, 6]
      t: [0.020833333333333332, 0.0625]
      w: [6, 6]

    var_rand:
      E: (+0) norm, {&#39;mean&#39;: &#39;1.049e+04&#39;, &#39;s.d.&#39;: &#39;1.223e+02&#39;, &#39;COV&#39;: 0.01, &#39;skew.&#39;: 0.0, &#39;kurt.&#39;: 3.0}
      mu: (+0) beta, {&#39;mean&#39;: &#39;3.300e-01&#39;, &#39;s.d.&#39;: &#39;1.000e-02&#39;, &#39;COV&#39;: 0.02, &#39;skew.&#39;: -1.81, &#39;kurt.&#39;: 6.859999999999999}

    copula:
      Gaussian copula with correlations:
  var1 var2      corr
0   mu    E  0.030128

  functions:
      Buckling strength: [&#39;E&#39;, &#39;mu&#39;, &#39;t&#39;, &#39;h&#39;, &#39;w&#39;, &#39;m&#39;] -&gt; [&#39;sigma_buckle&#39;]
</pre></div>
</div>
</div>
</div>
<p>When implementing a model it is a good idea to use sinews as a sanity check, as such a plot visualizes the effect of every input on every output of the model. The following code constructs a sinew plot of the plate model, with results shown in <strong><a class="reference internal" href="#fig-grama-sinews-plate"><span class="std std-numref">Figure 4.11</span></a></strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1"># Start with the plate model</span>
    <span class="n">md_plate</span>
    <span class="c1"># Evaluate data for a sinew plot</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sinews</span><span class="p">(</span><span class="n">df_det</span><span class="o">=</span><span class="s2">&quot;swp&quot;</span><span class="p">)</span>
    <span class="c1"># Construct the plot</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_auto</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Calling plot_sinew_outputs....
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/grama-intro_84_0.png" src="../_images/grama-intro_84_0.png" />
</div>
</div>
<div class="figure align-default" id="fig-grama-sinews-plate">
<p class="caption"><span class="caption-number">Fig. 4.11 </span><span class="caption-text">A sinew plot generated using the buckling plate model. Note that this model contains implementation errors, as described in the text!</span><a class="headerlink" href="#fig-grama-sinews-plate" title="Permalink to this image">#</a></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>These sinews indicate an incorrect model.</strong>
This sinew plot in <strong><a class="reference internal" href="#fig-grama-sinews-plate"><span class="std std-numref">Figure 4.11</span></a></strong> doesn’t match the intuition we stated above! As we increase the height <code class="docutils literal notranslate"><span class="pre">h</span></code> the plate becomes <em>harder</em> to buckle (the buckling stress increases), while when we make the plate thicker the plate becomes <em>easier</em> to buckle (buckling stress decreases). This is a <em>verification failure</em> that points to a potential mistake in the model implementation.</p>
</div>
<p>By sanity-checking the model with a sinew plot (<strong><a class="reference internal" href="#fig-grama-sinews-plate"><span class="std std-numref">Figure 4.11</span></a></strong>), we can see that the model has incorrect behavior. Reviewing the code above, it seems the <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(t\)</span> terms are swapped. We can fix that easily and rerun the sweeps:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fix the typo in the buckling strength equation</span>
<span class="n">md_plate_v2</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">md_aluminum_v2</span>
    <span class="c1"># Add the buckling strength equation</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_vec_function</span><span class="p">(</span>
        <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
            <span class="n">sigma_buckle</span>
              <span class="o">=</span><span class="mf">3.14159</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">E</span>
              <span class="o">/</span> <span class="mi">12</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
              <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># NB. Corrected typo</span>
              <span class="o">*</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">m</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">h</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">w</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">w</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">m</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">h</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>          
        <span class="p">),</span>
        <span class="n">var</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">],</span>
        <span class="n">out</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sigma_buckle&quot;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Buckling strength&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Add bounds for deterministic inputs</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_bounds</span><span class="p">(</span>
        <span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="c1"># Consider a range</span>
        <span class="n">w</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="c1"># Assume constrained by design</span>
        <span class="n">m</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="c1"># Assume first mode dominates</span>
        <span class="c1"># Based on tested plate thicknesses</span>
        <span class="n">t</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hidden input</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">md_plate_v2</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sinews</span><span class="p">(</span><span class="n">df_det</span><span class="o">=</span><span class="s2">&quot;swp&quot;</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">pt_auto</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Calling plot_sinew_outputs....
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/grama-intro_89_0.png" src="../_images/grama-intro_89_0.png" />
</div>
</div>
<div class="figure align-default" id="fig-grama-sinews-plate-fixed">
<p class="caption"><span class="caption-number">Fig. 4.12 </span><span class="caption-text">Sinew plot generated using the buckling plate model. This model is corrected from the version that produced <strong><a class="reference internal" href="#fig-grama-sinews-plate"><span class="std std-numref">Figure 4.11</span></a></strong>.</span><a class="headerlink" href="#fig-grama-sinews-plate-fixed" title="Permalink to this image">#</a></p>
</div>
<p>The updated model’s results matche our intuition (<strong><a class="reference internal" href="#fig-grama-sinews-plate-fixed"><span class="std std-numref">Figure 4.12</span></a></strong>), and provides a quantitative comparison between the effects of the inputs. Note that the range of critical buckling values is quite small in the material property panels, while the ranges associated with the plate thickness and length are much wider. This implies that we can adjust the plate dimensions to achieve our desired safety goal, as the buckling behavior is much more sensitive to the plate geometry than material properties.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Goals for this case study (revised)</strong>
Note that we had to specify bounds for the <em>height</em> of the plate to run the sweep. We didn’t specify a plate height in our original goal. To correct this oversight, let’s update our goal to specify plates <span class="math notranslate nohighlight">\(6\)</span> inches in height.</p>
</div>
<p>Finally, to complete our modeling, we will incorporate the target load of <span class="math notranslate nohighlight">\(1\)</span> ksi by defining a <em>limit state function</em> (see <a class="reference internal" href="../04_appendices/limit-state-models.html#s-limit-state"><span class="std std-numref">Appendix 11.8</span></a> for more details).</p>
<div class="math notranslate nohighlight">
\[g_{\text{buckle}} = \sigma_{\text{buckle}} - \sigma_{\text{applied}},\]</div>
<p>with <span class="math notranslate nohighlight">\(\sigma_{\text{applied}} = 1\)</span> ksi. The limit state function <span class="math notranslate nohighlight">\(g\)</span> standardizes the interpretation of our quantitative failure model: Cases where <span class="math notranslate nohighlight">\(g &gt; 0\)</span> correspond to safe operation, while those with <span class="math notranslate nohighlight">\(g \leq 0\)</span> correspond to failure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build a model with the design context:</span>
<span class="c1"># the applied load of 1 ksi</span>
<span class="n">md_buckling</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">md_plate_v2</span>
    <span class="c1"># Add the limit state function</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">cp_vec_function</span><span class="p">(</span>
        <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span>
            <span class="n">g_buckle</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">sigma_buckle</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="c1"># load in ksi</span>
        <span class="p">),</span>
        <span class="n">var</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sigma_buckle&quot;</span><span class="p">],</span>
        <span class="n">out</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;g_buckle&quot;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Limit state&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">md_buckling</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>model: Plate aluminum material properties

  inputs:
    var_det:
      m: [1, 1]
      h: [2, 6]
      t: [0.03125, 0.0625]
      w: [6, 6]

    var_rand:
      E: (+0) norm, {&#39;mean&#39;: &#39;1.049e+04&#39;, &#39;s.d.&#39;: &#39;1.223e+02&#39;, &#39;COV&#39;: 0.01, &#39;skew.&#39;: 0.0, &#39;kurt.&#39;: 3.0}
      mu: (+0) beta, {&#39;mean&#39;: &#39;3.300e-01&#39;, &#39;s.d.&#39;: &#39;1.000e-02&#39;, &#39;COV&#39;: 0.02, &#39;skew.&#39;: -1.81, &#39;kurt.&#39;: 6.859999999999999}

    copula:
      Gaussian copula with correlations:
  var1 var2      corr
0   mu    E  0.030128

  functions:
      Buckling strength: [&#39;E&#39;, &#39;mu&#39;, &#39;t&#39;, &#39;h&#39;, &#39;w&#39;, &#39;m&#39;] -&gt; [&#39;sigma_buckle&#39;]
      Limit state: [&#39;sigma_buckle&#39;] -&gt; [&#39;g_buckle&#39;]
</pre></div>
</div>
</div>
</div>
<p>Now we have a complete model with which to conduct our analysis.</p>
</div>
<div class="section" id="analyzing-the-model">
<h3><span class="section-number">4.3.2. </span>Analyzing the model<a class="headerlink" href="#analyzing-the-model" title="Permalink to this headline">#</a></h3>
<p>We are interested in determining a plate thickness that produces a chance of failure less than 1 in 100. To estimate the probability of failure (POF), we will use a Monte Carlo simulation technique with the probabilistic model we just constructed (see <a class="reference internal" href="../02_developing/propagation-algorithms.html#s-propagation-algorithms"><span class="std std-numref">Section 9.4</span></a> for more details).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Conversations with a Model: The Monte Carlo Method.</strong>
Zach. “What would Stan Ulam say about the Monte Carlo method?”</p>
<p>Bot. “I developed the Monte Carlo method while working on problems in the field of nuclear physics, but I soon realized that it could be applied to a wide range of other fields as well, including finance, engineering and computer science. By using random sampling techniques, the method is particularly useful for solving problems that involve a large number of variables and that are too complex to solve analytically.</p>
<p>The Monte Carlo method is named after the city of Monte Carlo in Monaco, which is famous for its casinos. The name is fitting because the method involves a large number of random trials, similar to the rolling of dice in a casino game. With each trial, we gain a better understanding of the system and can estimate the probability of different outcomes.”</p>
</div>
<p>To start, we will analyze a plate with a thickness of <span class="math notranslate nohighlight">\(1/48\)</span>”, the lower end of sizes considered in our dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="c1">## Perform a monte carlo analysis</span>
    <span class="c1"># Select a model with uncertainty</span>
    <span class="n">md_buckling</span>
    <span class="c1"># Generate a random sample</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sample</span><span class="p">(</span>
        <span class="n">n</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>    <span class="c1"># Sample size</span>
        <span class="n">seed</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="c1"># For reproducibility</span>
        <span class="c1"># Define the deterministic input values</span>
        <span class="n">df_det</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">48</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="c1"># Estimate the probability of failure (POF)</span>
    <span class="c1"># Include confidence interval endpoints: lo|up</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_summarize</span><span class="p">(</span>
        <span class="n">pof_lo</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">pr_lo</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">g_buckle</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">pof_est</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">pr</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">g_buckle</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">pof_up</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">pr_up</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">g_buckle</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="c1"># Round all numeric columns</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate_if</span><span class="p">(</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">is_numeric</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">gr</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eval_sample() is rounding n...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pof_lo</th>
      <th>pof_est</th>
      <th>pof_up</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.93</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Clearly, the POF is much higher than our desired <span class="math notranslate nohighlight">\(0.01\)</span>! Let’s try the other end of the thickness bounds with <span class="math notranslate nohighlight">\(1/16\)</span>”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="c1"># Study the buckling model</span>
    <span class="n">md_buckling</span>
    <span class="c1"># Perform simple Monte Carlo</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sample</span><span class="p">(</span>
        <span class="n">n</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
        <span class="n">df_det</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_summarize</span><span class="p">(</span>
        <span class="n">pof_lo</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">pr_lo</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">g_buckle</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">pof_est</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">pr</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">g_buckle</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">pof_up</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">pr_up</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">g_buckle</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="c1"># Round all numeric columns</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate_if</span><span class="p">(</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">is_numeric</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">gr</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eval_sample() is rounding n...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pof_lo</th>
      <th>pof_est</th>
      <th>pof_up</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.07</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The estimated POF (<code class="docutils literal notranslate"><span class="pre">pof_est</span></code>) is zero! That certainly satisfies our goal of <code class="docutils literal notranslate"><span class="pre">pof</span> <span class="pre">&lt;</span> <span class="pre">0.01</span></code>, but it seems fishy….</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Calculation tolerances.</strong>
The Monte Carlo approach gives us an estimate for our target quantity, but also a <strong>confidence interval</strong> (CI). A CI gives us a possible range in which true value may land, which requires careful interpretation of results. The CI we see here violates our constraint (<code class="docutils literal notranslate"><span class="pre">pof_up</span> <span class="pre">&gt;</span> <span class="pre">0.01</span></code>), which indicates that our simulation needs more refinement—a larger sample size—to provide a more trustworthy answer.</p>
</div>
<p>We can refine our simulation by increasing the sample size <code class="docutils literal notranslate"><span class="pre">n</span></code> in our Monte Carlo evaluation. A rough rule of thumb when estimating low-probability events is to use a sample size of <span class="math notranslate nohighlight">\(n = 20 / p\)</span>, where <span class="math notranslate nohighlight">\(p\)</span> is our best guess for the small probability. Because we’re targeting a failure rate of 1 in 100, we’ll set <span class="math notranslate nohighlight">\(p = 0.01\)</span> and apply the heuristic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="c1"># Study the buckling model</span>
    <span class="n">md_buckling</span>
    <span class="c1"># Perform simple Monte Carlo</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">ev_sample</span><span class="p">(</span>
        <span class="c1"># Use the rule of thumb for sample size</span>
        <span class="n">n</span><span class="o">=</span><span class="mi">20</span> <span class="o">/</span> <span class="mf">0.01</span><span class="p">,</span> 
        <span class="n">seed</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
        <span class="n">df_det</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">df_make</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_summarize</span><span class="p">(</span>
        <span class="n">pof_lo</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">pr_lo</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">g_buckle</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">pof_est</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">pr</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">g_buckle</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">pof_up</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">pr_up</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">g_buckle</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="c1"># Round all numeric columns</span>
    <span class="o">&gt;&gt;</span> <span class="n">gr</span><span class="o">.</span><span class="n">tf_mutate_if</span><span class="p">(</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">is_numeric</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">gr</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eval_sample() is rounding n...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pof_lo</th>
      <th>pof_est</th>
      <th>pof_up</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.004</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The POF estimate is still zero, but the upper confidence interval end (<code class="docutils literal notranslate"><span class="pre">pof_up</span></code>) is now below our target of <span class="math notranslate nohighlight">\(0.01\)</span>. This is a success! We have refined our results and found a thickness that confidently satisfies our POF constraint. This achieves our goal and finishes the case study.</p>
<div class="admonition-exercise-minimize-the-thickness admonition">
<p class="admonition-title"><strong>Exercise: Minimize the thickness.</strong></p>
<p>Using the code just given, try to find the minimum thickness <code class="docutils literal notranslate"><span class="pre">t</span></code> that still satisfies the POF constraint <code class="docutils literal notranslate"><span class="pre">pof_up</span> <span class="pre">&lt;=</span> <span class="pre">0.01</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="a-general-process">
<h2><span class="section-number">4.4. </span>A general process<a class="headerlink" href="#a-general-process" title="Permalink to this headline">#</a></h2>
<p>The brief case study given in <a class="reference internal" href="#grama-brief"><span class="std std-numref">Chapter 4.3</span></a> suggests an iterative process you can use to approach model analysis under uncertainty. <a class="reference internal" href="modeling-process.html#modeling-process"><span class="std std-numref">Chapter 3</span></a> details a full <em>modeling process</em>, but in brief, you should:</p>
<ul class="simple">
<li><p>Define the <strong>goals</strong> for your study. Use these goals to focus your work, but remain open to adjusting your goals if necessary.</p>
<ul>
<li><p>This might include making your goal more specific, as we did with specifying a plate length.</p></li>
</ul>
</li>
<li><p>Iteratively <strong>build</strong> a model for your study. This includes specifying the functions, the inputs, and a description of the inputs with bounds or a joint density.</p>
<ul>
<li><p>The ideal approach is to use representative data to inform your model. We used a dataset of measured aluminum properties.</p></li>
<li><p>If data are not available, consulting literature is an acceptable way to build your model. We used a classic reference to arrive at the buckling function.</p></li>
<li><p>You will likely discover surprises along the way, as we saw with the thickest plate specimens. These may necessitate follow-up studies or reasonable assumptions.</p></li>
</ul>
</li>
<li><p>Iteratively <strong>analyze</strong> your model to provide trustworthy results that support your goal.</p>
<ul>
<li><p>You will likely have to iterate on your methods to arrive at trustworthy results, as we saw with refining the Monte Carlo simulation.</p></li>
</ul>
</li>
</ul>
<p>Throughout the whole process, use the dual modes of curiosity and skepticism to guide your process.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="anacondaurl"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>see <code class="docutils literal notranslate"><span class="pre">https://www.anaconda.com/distribution/</span></code></p>
</dd>
<dt class="label" id="jb"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>We are thankful to the folks at the <a class="reference external" href="https://jupyterbook.org/intro.html">Jupyter Book</a> project, whose work enabled this Python-powered textbook!</p>
</dd>
<dt class="label" id="overview-page"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>For one such tutorial, see <a class="reference external" href="https://jupyterlab.readthedocs.io/en/stable/getting_started/overview.html">https://jupyterlab.readthedocs.io/en/stable/getting_started/overview.html</a></p>
</dd>
<dt class="label" id="n-sweeps"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Formally, the computational complexity is linear in <code class="docutils literal notranslate"><span class="pre">n_sweeps</span></code>.</p>
</dd>
<dt class="label" id="stretch"><span class="brackets"><a class="fn-backref" href="#id7">5</a></span></dt>
<dd><p>More formally, elasticity is a material property while stiffness is a property of a structure. Elasticity is assumed to vary only by the choice of material, while stiffness is a function of both the material elastic properties and the geometry of the structure.</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./01_orienting"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="modeling-process.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">3. </span>The Modeling Process</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="data-tools.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>A Brief Introduction to Data Tools</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Zachary del Rosario, Gianluca Iaccarino<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>